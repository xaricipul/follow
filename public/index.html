<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Followers Page</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js"></script>
  <link rel="stylesheet" href="assets/css/reset.css?v=1.0">
  <link rel="stylesheet" href="assets/css/style.css?v=1.0">
  <script type="text/javascript" src="words.js"></script>
  <script type="text/javascript" src="msg.js"></script>
  <script type="text/javascript" src="assets/tts/speakClient.js"></script>
  <script type="text/javascript" src="assets/js/jquery.js"></script>
  <script type="text/javascript" src="assets/js/socket.io.js"></script>
  <script type="text/javascript" src="assets/js/connection.js"></script>
  <script type="text/javascript" src="assets/js/app.js"></script>
  <script src="https://code.responsivevoice.org/responsivevoice.js?key=2u7Qd768"></script>
  <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
  <link rel="stylesheet" href="RacingGame.css">
  <link rel="stylesheet" href="https://storage.streamdps.com/css/core.min.css">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/jquery.marquee/1.4.0/jquery.marquee.min.js"></script>
  <style>
    .highlight {
      background-color: #3b82f6 !important;
      color: white;
    }

    .online,
    .offline {
      display: inline-block;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      margin-left: 10px;
    }

    .online {
      background-color: green;
      animation: flash 1s infinite;
    }

    .offline {
      background-color: red;
      animation: flash 1s infinite;
    }

    @keyframes flash {
      0% {
        opacity: 1;
      }
      50% {
        opacity: 0;
      }
      100% {
        opacity: 1;
      }
    }

    body {
      background: transparent;
    }
  </style>
</head>

<body class="h-screen flex flex-col items-center justify-center text-white">

  <div id="followers-list" class="bg-transparent rounded-lg shadow-lg p-6 w-full max-w-3xl overflow-auto h-[80vh] mt-52 mb-52 text-black"></div>

  <div id="myModal" class="fixed inset-0 bg-gray-800 bg-opacity-75 flex items-center justify-center hidden">
    <div class="bg-white rounded-lg p-6 shadow-lg text-center text-black bg-opacity-50">
      <p id="modal-text"></p>
    </div>
  </div>

  <script>
    let displayTimeout;
    let scrollInterval;

    function showModal(username, followerCount) {
      const modal = document.getElementById("myModal");
      const modalText = document.getElementById("modal-text");
      modalText.innerHTML = `<strong>${username}</strong> <strong>${followerCount}</strong> takipçi qazandı!`;
      modal.classList.remove('hidden');
      gsap.fromTo(modal, { opacity: 0 }, { opacity: 1, duration: 0.5 });
      setTimeout(() => {
        gsap.to(modal, { opacity: 0, duration: 0.5, onComplete: () => modal.classList.add('hidden') });
      }, 3000);
    }

    function updateFollowersList() {
      clearTimeout(displayTimeout);
      clearInterval(scrollInterval);

      userNameList.sort((a, b) => b.followCount - a.followCount); // Sort by followCount

      const followersList = document.getElementById('followers-list');
      followersList.innerHTML = '';
      userNameList.forEach((follower, index) => {
        const followerItem = document.createElement('div');
        followerItem.classList.add('p-2', 'border-b', 'border-gray-200', 'flex', 'justify-between', 'items-center', 'rounded-lg', 'mb-2', 'bg-opacity-50');
        if (follower.isNew) {
          followerItem.classList.add('highlight');
          gsap.from(followerItem, { scale: 0.5, duration: 0.5, ease: "back.out(1.7)" });
          follower.isNew = false;
        }
        followerItem.innerHTML = `
          <span>${index + 1}. ${follower.username}</span>
          <span>Toplam: ${follower.followCount} : Göndərilən: ${follower.sendFollowCount}</span>
          <span class="${follower.active ? 'online' : 'offline'}"></span>
        `;
        followersList.appendChild(followerItem);
      });

      displayTimeout = setTimeout(() => {
        scrollToTop();
      }, 3000);
    }

    function scrollToBottom() {
      const followersList = document.getElementById('followers-list');
      gsap.to(followersList, { scrollTop: followersList.scrollHeight, duration: 1 });
    }

    function scrollToTop() {
      const followersList = document.getElementById('followers-list');
      scrollInterval = setInterval(() => {
        if (followersList.scrollTop > 0) {
          followersList.scrollTop -= 10;
        } else {
          clearInterval(scrollInterval);
        }
      }, 10);
    }

    // Sample data for testing
    // let userNameList = [
    //   { username: 'User1', followCount: 150, sendFollowCount: 50, active: true, isNew: false },
    //   { username: 'User2', followCount: 200, sendFollowCount: 60, active: true, isNew: false },
    //   { username: 'User3', followCount: 100, sendFollowCount: 40, active: false, isNew: false }
    // ]; 

    // Initial display
    updateFollowersList();
  </script>
</body>

</html>
